 ğŸ¤”ğŸ¤”

=> ğŸš€ AppManager â€“ Entwicklerdokumentation

Stand: 27. Juli 2025 â€“ Status: Development-Phase abgeschlossen, UI-Integration in Arbeit

---

=> 1. ProjektÃ¼bersicht

AppManager ist eine ASP.NET Core 9.0 Webanwendung zum Verwalten und Steuern von Server-Anwendungen mit rollenbasiertem Zugriff, Audit-Trail und Administrationsbereich.

=> Hauptfunktionen

 â–¶ï¸ Starten, Stoppen & Neustarten von Anwendungen
 ğŸ‘¥ App-Owner-System zur Verwaltung von Benutzerberechtigungen
 ğŸ—„ï¸ SQL Server Integration mit Windows-Authentifizierung
 ğŸŒ Web-Adminbereich fÃ¼r App- & Benutzerverwaltung
 ğŸ” ASP.NET Core Identity fÃ¼r Authentifizierung & Autorisierung

---

=> 2. Technische Basis

=> Technologien

 Backend: ASP.NET Core 9.0 (ohne Kestrel â€“ Compliance)
 Frontend: Razor Pages
 Datenbank: SQL Server mit Entity Framework Core 8.0.11 /Sqlite
 Authentifizierung: ASP.NET Core Identity + Windows Auth
 Deployment: IIS mit Windows-Authentifizierung

=> Server-Umgebungen

 Development: LocalDB ('AppManagerTest')
 Production: 'buhlertal123' Server ('APPUSER')
 Verbindung: Windows-Authentifizierung ('Trusted_Connection=true')

---

=> 3. Projektstruktur

ğŸ
AppManager/
â”œâ”€â”€ Data/                 => Identity + DbContext
â”œâ”€â”€ Models/               => Application, AppOwnership, AppLaunchHistory
â”œâ”€â”€ Services/             => Business-Logik (AppService, ProgramManager)
â”œâ”€â”€ Pages/                => Razor Pages (Admin, Account, Shared)
â”œâ”€â”€ TestDataSeeder.cs     => Dev-Daten
â”œâ”€â”€ ProductionSeeder.cs   => Prod-Daten
â””â”€â”€ Program.cs            => Startup & Konfiguration
ğŸ

---

=> 4. Datenmodelle

=> Application

ğŸcsharp
public class Application
{
    public Guid Id { get; set; }
    public string Name { get; set; }
    public string Description { get; set; }
    public string ExecutablePath { get; set; }
    public bool IsStarted { get; set; }
    public bool RestartRequired { get; set; }
}
ğŸ

=> AppUser (erweitert IdentityUser)

ğŸcsharp
public class AppUser : IdentityUser
{
    public string Vorname { get; set; }
    public string Nachname { get; set; }
    public bool IsActive { get; set; }
    public DateTime CreatedAt { get; set; }
}
ğŸ

=> AppOwnership

ğŸcsharp
public class AppOwnership
{
    public Guid Id { get; set; }
    public string UserId { get; set; }
    public Guid ApplicationId { get; set; }
    public string WindowsUsername { get; set; }
    public string IISAppPoolName { get; set; }
    public DateTime CreatedAt { get; set; }
    public string CreatedBy { get; set; }
    public AppUser User { get; set; }
    public Application Application { get; set; }
}
ğŸ

=> AppLaunchHistory

ğŸcsharp
public class AppLaunchHistory
{
    public Guid Id { get; set; }
    public Guid ApplicationId { get; set; }
    public string UserId { get; set; }
    public string Action { get; set; } // "Start", "Stop", "Restart"
    public DateTime LaunchTime { get; set; }
    public string Reason { get; set; }
    public Application Application { get; set; }
    public AppUser User { get; set; }
}
ğŸ

---

=> 5. Razor Pages & API-Referenz

=> SeitenÃ¼bersicht

| Page                      | Route                          | Autorisation                 | Zweck              | Backend-Model                |
| ------------------------- | ------------------------------ | ---------------------------- | ------------------ | ---------------------------- |
| Index                 | '/'                            | None                         | Ãœbersicht          | 'IndexModel'                 |
| Login                 | '/Account/Login'               | None                         | Benutzeranmeldung  | 'LoginModel'                 |
| Register              | '/Account/Register'            | None                         | Registrierung      | 'RegisterModel'              |
| SwitchRole            | '/Account/SwitchRole'          | '[Authorize]'                | Rollenwechsel      | 'SwitchRoleModel'            |
| Dashboard             | '/Admin/Dashboard'             | '[Authorize]'                | App-Management     | 'DashboardModel'             |
| Users                 | '/Admin/Users'                 | '[Authorize(Roles="Admin")]' | Benutzerverwaltung | 'UsersModel'                 |
| AppOwnership          | '/Admin/AppOwnership'          | '[Authorize(Roles="Admin")]' | Berechtigungen     | 'AppOwnershipModel'          |
| ApplicationManagement | '/Admin/ApplicationManagement' | '[Authorize(Roles="Admin")]' | App-CRUD           | 'ApplicationManagementModel' |
| History               | '/Admin/History'               | '[Authorize]'                | Audit-Trail        | 'HistoryModel'               |
| Diagrams              | '/Admin/Diagrams'              | '[Authorize(Roles="Admin")]' | Systemdiagramme    | 'DiagramsModel'              |

---

=> Wichtige Handler

=> Dashboard:

ğŸcsharp
public async Task OnGetAsync();
public async Task<IActionResult> OnPostStartAsync(Guid appId);
public async Task<IActionResult> OnPostStopAsync(Guid appId);
public async Task<IActionResult> OnPostRestartAsync(Guid appId);
ğŸ

=> Users:

ğŸcsharp
public void OnGet();
public async Task<IActionResult> OnPostAsync();
public async Task<IActionResult> OnPostEditAsync();
public async Task<IActionResult> OnPostDeleteAsync(string userId);
public async Task<IActionResult> OnPostToggleActiveAsync(string userId);
ğŸ

=> ApplicationManagement:

ğŸcsharp
public async Task OnGetAsync();
public async Task<IActionResult> OnPostAsync();
public async Task<IActionResult> OnPostEditAsync();
public async Task<IActionResult> OnPostDeleteAsync(Guid appId);
ğŸ

=> AppOwnership:

ğŸcsharp
public async Task OnGetAsync();
public async Task<IActionResult> OnPostAsync();
public async Task<IActionResult> OnPostDeleteAsync(Guid ownershipId);
ğŸ

=> SwitchRole:

ğŸcsharp
public async Task<IActionResult> OnGetAsync();
public async Task<IActionResult> OnPostToggleAdminModeAsync();
ğŸ

---

=> 6. Sicherheitsmodell

=> Rollenmatrix

| Rolle         | Dashboard | Users | AppOwnership | ApplicationManagement | History | Diagrams | SwitchRole |
| ------------- | :-------: | :---: | :----------: | :-------------------: | :-----: | :------: | :--------: |
| Anonymous |     âŒ     |   âŒ   |       âŒ      |           âŒ           |    âŒ    |     âŒ    |      âŒ     |
| AppOwner  |     âœ…     |   âŒ   |       âŒ      |           âŒ           |    âœ…    |     âŒ    |      âŒ     |
| Admin     |     âœ…     |   âœ…   |       âœ…      |           âœ…           |    âœ…    |     âœ…    |      âœ…     |

=> AdminMode-Claim

ğŸcsharp
User.HasClaim("AdminMode", "true"); // Zeigt Admin-Features
User.HasClaim("AdminMode", "false"); // Zeigt nur Basis-Features
ğŸ

---

=> 7. Setup & Deployment

=> Projekt erstellen

ğŸpowershell
dotnet new webapp -n AppManager
cd AppManager
ğŸ

=> NuGet-Pakete

ğŸpowershell
dotnet add package Microsoft.AspNetCore.Identity.EntityFrameworkCore
dotnet add package Microsoft.EntityFrameworkCore.SqlServer
dotnet add package Microsoft.EntityFrameworkCore.Tools
dotnet add package Microsoft.AspNetCore.Identity.UI
ğŸ

=> SQL Server LocalDB Setup

ğŸpowershell
sqllocaldb create "AppManagerTest" -s
dotnet ef migrations add "SqlServerMigration"
dotnet ef database update
ğŸ

=> Build & Run

ğŸpowershell
taskkill /F /IM AppManager.exe
dotnet build
dotnet run --launch-profile http
ğŸ

URL: 'http://localhost:5130'

---

=> 8. Seeder

 TestDataSeeder: Dummy-Apps (Paint, Rechner) â€“ nur Development
 ProductionSeeder: Standard-Windows-Apps (Explorer, Notepad, CMD) â€“ alle Umgebungen

---

=> 9. Connection Strings

Development:

ğŸjson
"Server=(localdb)\\MSSQLLocalDB;Database=AppManagerTest;Trusted_Connection=true;"
ğŸ

Production:

ğŸjson
"Server=buhlertal123;Database=APPUSER;Trusted_Connection=true;"
ğŸ

---

=> 10. Status & Roadmap

 [x] Kestrel entfernt
 [x] SQL Server + Migration
 [x] App-Owner-System
 [x] Windows-Authentifizierung
 [ ] UI fÃ¼r App-Owner-Management
 [ ] IIS AppPool-Integration
 [ ] Active Directory Integration

---

=> 11. Debugging & Tipps

Process in use-Fehler:

ğŸpowershell
taskkill /F /IM AppManager.exe
ğŸ

Migration zurÃ¼ckrollen:

ğŸpowershell
dotnet ef database update NameDerVorherigenMigration
ğŸ

Kestrel prÃ¼fen:

ğŸpowershell
dotnet list package | findstr -i kestrel
ğŸ

---

=> 12. Git Repository

ğŸpowershell
git init
git add .
git commit -m "Initial commit"
git branch -M main
git remote add origin https://github.com/Guelistan/Appmanager.git
git push -u origin main
ğŸ

---

=> 13. NÃ¤chste Schritte

 Admin-Dashboard erweitern (App-ZustÃ¤nde + AppPool-Steuerung)
 IIS Management API anbinden
 Deployment auf buhlertal123

--- 

dotnet publish -r win-x64 --self-contained -o "C:\Users\user\OneDrive\Desktop\OrdnerPush1"
